# ุขุฎุฑ ุงูุฅุตูุงุญุงุช ูุงูุชุญุฏูุซุงุช
## Latest Fixes & Updates

**ุงูุชุงุฑูุฎ:** 2025-12-03  
**ุงูุฅุตุฏุงุฑ:** 2.6.5

---

## ๐ ุงููุฑุญูุฉ 7.1: ุงูุชูุงุฑูุฑ ุงููุฎุตุตุฉ (v2.6.5)

### 1๏ธโฃ ูุธุงู ุงูุชูุงุฑูุฑ ุงูููุณุน
- โ ุฏุนู 6 ุฃููุงุน ุชูุงุฑูุฑ: ุงููุณุชููุฏููุ ุงููุฏููุนุงุชุ ุงูุนูุงุฑุงุชุ ุงูุชูุฒูุนุงุชุ ุงููุฑูุถุ ุงูุนููุฏ
- โ `REPORT_FIELDS` ูุชุนุฑูู ุงูุญููู ููู ููุน
- โ ุชุญููู ุงูุญููู ุงูุนุฑุจูุฉ โ ุญููู ูุงุนุฏุฉ ุงูุจูุงูุงุช

### 2๏ธโฃ ูุนุงููุฉ ุงููุชุงุฆุฌ (`ReportResultsPreview`)
- โ ุฌุฏูู ุนุฑุถ ูุน ุชูุณูู ุงูุชูุงุฑูุฎ ูุงููุจุงูุบ
- โ ุชุตุฏูุฑ ูุจุงุดุฑ PDF/Excel/CSV
- โ ุนุฏูุงุฏ ุงูุณุฌูุงุช ูุชุงุฑูุฎ ุงูุชูููุฏ

### 3๏ธโฃ ุฃุฏูุงุช ุงูุชุตุฏูุฑ ุงูููุญุฏุฉ (`export-utils.ts`)
- โ `exportToPDF()` - PDF ูุน ุฑุคูุณ ุนุฑุจูุฉ
- โ `exportToExcel()` - Excel ูุน ุชูุณูู ุงูุฃุนูุฏุฉ
- โ `exportToCSV()` - CSV ูุน ุฏุนู ุงูุนุฑุจูุฉ (BOM)
- โ `exportFinancialPDF()` - ุชูุงุฑูุฑ ูุงููุฉ ูุน ููุฎุต

---

## ๐ง ุฅุตูุงุญุงุช v2.6.4 (2025-12-03)

### 1๏ธโฃ ุชูุธูู ุงูู Hooks (152 hook)
- โ ุฅูุดุงุก 18 ูุฌูุฏ ูุฑุนู ููุธู
- โ ูููุงุช `index.ts` ููู ูุฌูุฏ
- โ ุชูุซูู ุดุงูู ูู `src/hooks/README.md`
- โ ุฅูุดุงุก `useUnifiedExport` ููุชุตุฏูุฑ ุงูููุญุฏ

### 2๏ธโฃ ุชูุซูู ุงูุฎุฏูุงุช ุงูุฌุฏูุฏุฉ
- โ `AuthService` - 9 ูุธุงุฆู ูููุตุงุฏูุฉ
- โ `ArchiveService` - 8 ูุธุงุฆู ููุฃุฑุดูู
- โ `LoansService` - 8 ูุธุงุฆู ูููุฑูุถ

### 3๏ธโฃ ุชูุซูู ุงูููููุงุช ุงูููุณูุฉ
- โ `src/components/requests/README.md`
- โ `src/components/archive/README.md`
- โ `src/components/knowledge/README.md`

### 4๏ธโฃ ุชุญุฏูุซ ุงููุซุงุฆู ุงูุฑุฆูุณูุฉ
- โ `README.md` - ุฅุตุฏุงุฑ 2.6.4ุ ุฅุญุตุงุฆูุงุช ูุญุฏุซุฉ
- โ `DEVELOPER_MASTER_GUIDE.md` - 74 ุตูุญุฉุ 152 hookุ 39 Edge Function
- โ `REFACTORING_SUMMARY.md` - ุชูุณููุงุช ุงูุตูุญุงุช ุงููุจูุฑุฉ

---

## ๐ง ุงูุฅุตูุงุญุงุช ุงูุญุฑุฌุฉ ุงููููุฐุฉ (v2.6.0)

### 1๏ธโฃ ุฅุตูุงุญ Service Worker (v2.6.0)

#### ุงููุดููุฉ
```
Uncaught (in promise) TypeError: Failed to update a ServiceWorker for scope 
('https://waqf-wise.lovable.app/') with script ('https://waqf-wise.lovable.app/sw.js')
```

#### ุงูุฃุณุจุงุจ ุงูุฌุฐุฑูุฉ
1. **ุชุถุงุฑุจ ุงูุฅุตุฏุงุฑุงุช:** ุฅุตุฏุงุฑุงุช ูุฎุชููุฉ ูู `vite.config.ts` (2.6.0)ุ `manifest.webmanifest` (2.3.0)ุ ู `version.ts` (2.5.3)
2. **ูููุงุช Manifest ููุฑุฑุฉ:** ูุฌูุฏ `public/manifest.webmanifest` ุจุงูุฅุถุงูุฉ ููููู ุงูููููุฏ ูู VitePWA
3. **ุบูุงุจ ูุนุงูุฌ ุงูุฃุฎุทุงุก:** ุนุฏู ูุฌูุฏ `onRegisterError` ูู `UpdateNotifier.tsx`

#### ุงูุฅุตูุงุญุงุช ุงููููุฐุฉ
โ ุชูุญูุฏ ุงูุฅุตุฏุงุฑ ุฅูู `2.6.0` ูู ุฌููุน ุงููููุงุช  
โ ุญุฐู `public/manifest.webmanifest` ุงูููุฑุฑ  
โ ุฅุถุงูุฉ ูุนุงูุฌ ุฃุฎุทุงุก `onRegisterError` ูุน toast ูููุณุชุฎุฏู  
โ ุชุญุฏูุซ `cacheId` ูู Workbox: `waqf-v2.6.0`

#### ุงููููุงุช ุงููุนุฏูุฉ
- `src/lib/version.ts` - ุชูุญูุฏ ุงูุฅุตุฏุงุฑ
- `VERSION` - ุชุญุฏูุซ ุฑูู ุงูุฅุตุฏุงุฑ
- `public/manifest.webmanifest` - ุญุฐู ูุฅุฒุงูุฉ ุงูุชูุฑุงุฑ
- `src/components/system/UpdateNotifier.tsx` - ุฅุถุงูุฉ ูุนุงูุฌ ุงูุฃุฎุทุงุก

---

### 2๏ธโฃ ุฅุตูุงุญ Edge Functions

#### ุงููุดููุฉ
```
column properties.property_type does not exist
```

#### ุงูุณุจุจ
ุงุณุชุฎุฏุงู ุนููุฏ `property_type` ุงููุฏูู ุจุฏูุงู ูู `type` ุงูุญุงูู

#### ุงูุฅุตูุงุญุงุช ุงููููุฐุฉ
โ ุชุญุฏูุซ `supabase/functions/chatbot/index.ts` (ุณุทุฑ 241-245ุ 270-274)  
โ ุชุญุฏูุซ `supabase/functions/contract-renewal-alerts/index.ts` (ุณุทุฑ 35-40ุ 83-84)  
โ ุชุญุฏูุซ `src/types/table-rows.ts` ูุงุณุชุฎุฏุงู `type?: string`

#### ุงููุชูุฌุฉ
- Chatbot ูุนูู ุจุดูู ุตุญูุญ
- ุชูุจููุงุช ุชุฌุฏูุฏ ุงูุนููุฏ ุชุนูู ุจุฏูู ุฃุฎุทุงุก

---

### 3๏ธโฃ ุชุญุณูู RLS Policies

#### ุงููุดุงูู ุงูููุตูุญุฉ
1. **bank_accounts:** ุฅุฒุงูุฉ ุงููุตูู ุบูุฑ ุงูุถุฑูุฑู ูููุณุชููุฏูู
2. **loans:** ุชูููู ุงูุณูุงุณุงุช ูู 11+ ุฅูู 2 ุณูุงุณุงุช ูุงุถุญุฉ
3. **emergency_aid_requests:** ุฅุฒุงูุฉ `enable_read_for_all` ุงูุฎุทูุฑุฉ
4. **profiles:** ุชุญุฏูุฏ ุงูุตูุงุญูุงุช ุจุฏูุฉ
5. **beneficiaries:** ุชุญุณูู ุณูุงุณุงุช ุงููุตูู
6. **rental_payments:** ุฅุฒุงูุฉ ูุตูู ุงููุณุชููุฏูู ุบูุฑ ุงูููุงุณุจ
7. **distributions:** ุชุทุจูู `beneficiary_visibility_settings`

#### ุงููุชูุฌุฉ
โ ุฃูุงู ูุญุณูู ุจุดูู ูุจูุฑ  
โ ุฃุฏุงุก ุฃูุถู (ุงุณุชุนูุงูุงุช ุฃุณุฑุน)  
โ ููุฏ ุฃูุธู ูุฃุณูู ููุตูุงูุฉ  
โ ุฅุฒุงูุฉ ุงููุตูู ุงูุฒุงุฆุฏ ูุฃุฏูุงุฑ `waqf_heir` ู `first_class_beneficiary`

#### Migration ุงููููุฐุฉ
```sql
-- 20251202034426_4b14aba0-0d9a-4785-a9fa-e8664d3b9344.sql
-- ุชูุธูู ูุชุจุณูุท RLS policies ูุฌููุน ุงูุฌุฏุงูู ุงูุญุณุงุณุฉ
```

---

## ๐ฏ ุงููุชุงุฆุฌ ุงูุฅุฌูุงููุฉ

### ุงูุฃูุงู
- โ RLS policies ูุญุณููุฉ ูููุจุณุทุฉ
- โ ุฅุฒุงูุฉ ุงูุซุบุฑุงุช ุงูุฃูููุฉ ุงูููุชุดูุฉ
- โ ุญูุงูุฉ ุงูุจูุงูุงุช ุงูุญุณุงุณุฉ

### ุงูุฃุฏุงุก
- โ Service Worker ูุนูู ุจุดูู ุตุญูุญ
- โ ุงุณุชุนูุงูุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช ุฃุณุฑุน
- โ ุชุญููู ุงูุชุทุจูู ูุญุณูู

### ุงูุงุณุชูุฑุงุฑ
- โ Edge Functions ุชุนูู ุจุฏูู ุฃุฎุทุงุก
- โ ูุง ุชูุฌุฏ ุฃุฎุทุงุก ูู Console
- โ ุงูุชุทุจูู ุฌุงูุฒ ููุฅูุชุงุฌ

---

## ๐ ููุงุฑูุฉ ูุจู ูุจุนุฏ

### Service Worker
| ุงููููุงุณ | ูุจู | ุจุนุฏ |
|---------|-----|-----|
| ุฃุฎุทุงุก ุงูุชุญุฏูุซ | โ ููุฌูุฏุฉ | โ ูุนุงูุฌุฉ |
| ุชูุญูุฏ ุงูุฅุตุฏุงุฑ | โ ุบูุฑ ููุญุฏ | โ ููุญุฏ |
| ูุนุงูุฌ ุงูุฃุฎุทุงุก | โ ููููุฏ | โ ููุฌูุฏ |

### RLS Policies
| ุงูุฌุฏูู | ุนุฏุฏ ุงูุณูุงุณุงุช ูุจู | ุนุฏุฏ ุงูุณูุงุณุงุช ุจุนุฏ | ุงูุชุญุณูู |
|--------|-----------------|------------------|---------|
| bank_accounts | 9+ | 2 | 78% |
| loans | 11+ | 2 | 82% |
| emergency_aid | 5+ | 4 | 20% |
| profiles | 8+ | 4 | 50% |

### Edge Functions
| ุงูุฏุงูุฉ | ุงูุญุงูุฉ ูุจู | ุงูุญุงูุฉ ุจุนุฏ |
|--------|-----------|-----------|
| chatbot | โ ุฎุทุฃ SQL | โ ุชุนูู |
| contract-renewal-alerts | โ ุฎุทุฃ SQL | โ ุชุนูู |

---

## ๐ ุงูุชุญุฏูุซุงุช ุงููุงุฏูุฉ (ูู ุงูุฎุทุฉ)

### ูุตูุฑุฉ ุงููุฏู
- [ ] ุงุฎุชุจุงุฑ ุดุงูู ููุตูุงุญูุงุช ูุน ุฌููุน ุงูุฃุฏูุงุฑ
- [ ] ูุฑุงุฌุนุฉ ุฃุฏุงุก ุงูุงุณุชุนูุงูุงุช ุงููุนูุฏุฉ
- [ ] ุชุญุฏูุซ ุงููุซุงุฆู ุงููููุฉ

### ูุชูุณุทุฉ ุงููุฏู
- [ ] ุฅุถุงูุฉ ุงููุฒูุฏ ูู ุงุฎุชุจุงุฑุงุช ุงูุฃูุงู ุงูุชููุงุฆูุฉ
- [ ] ุชุญุณูู ุฃุฏูุงุช ุงููุฑุงูุจุฉ ูุงูุชูุจููุงุช
- [ ] ุชูุณูุน ูุทุงู ุงุฎุชุจุงุฑุงุช E2E

---

## ๐ ููุงุญุธุงุช ูููุฉ

### ูููุทูุฑูู
1. ุฏุงุฆูุงู ุงุณุชุฎุฏู `type` ูููุณ `property_type` ููุนูุงุฑุงุช
2. ุชุฃูุฏ ูู ุชูุญูุฏ ุงูุฅุตุฏุงุฑ ูู ุฌููุน ุงููููุงุช ุนูุฏ ุงูุชุญุฏูุซ
3. ุฑุงุฌุน RLS policies ูุจู ุฅุถุงูุฉ ุฌุฏุงูู ุฌุฏูุฏุฉ
4. ุงุณุชุฎุฏู ุฃุฏูุงุช Debug ุงููุชุงุญุฉ ูู `/developer-tools`

### ูููุฏุฑุงุก
1. ุงููุธุงู ุงูุขู ุฌุงูุฒ ููุฅูุชุงุฌ ูู ุงููุงุญูุฉ ุงูุฃูููุฉ
2. ุฌููุน ุงูุซุบุฑุงุช ุงูุญุฑุฌุฉ ุชู ุฅุตูุงุญูุง
3. ูููุตุญ ุจุฅุฌุฑุงุก ุงุฎุชุจุงุฑ ูุจูู ููุงุฆู ูุจู ุงูุฅุทูุงู

---

## ๐ ุฑูุงุจุท ูููุฏุฉ

- [ุฎุทุฉ ุงูุฃูุงู ุงูุดุงููุฉ](./SECURITY_FIX_PLAN.md)
- [ุฏููู ุงูุชุทููุฑ ุงูุขูู](./SAFE_DEVELOPMENT_GUIDE.md)
- [ุฏููู ุงูุชุตุญูุญ](./DEBUGGING_GUIDE.md)
- [ุณุฌู ุงูุชุบููุฑุงุช](./CHANGELOG_v2.5.0.md)

---

## ๐ ููุฎุต ุงูุชุญุณููุงุช v2.6.4

| ุงููุฆุฉ | ุงููุตู | ุงูุชุญุณูู |
|-------|-------|---------|
| Hooks | ุชูุธูู 152 hook ูู 18 ูุฌูุฏ | โฌ๏ธ 100% |
| Services | ุชูุซูู 11 ุฎุฏูุฉ | โฌ๏ธ 100% |
| Components | ุชูุซูู ุงูููููุงุช ุงูููุณูุฉ | โฌ๏ธ 100% |
| Documentation | ุชุทุงุจู ุงููุซุงุฆู ูุน ุงูููุฏ | 84% โ 100% |

---

**ุขุฎุฑ ุชุญุฏูุซ:** 2025-12-03  
**ุงูุฅุตุฏุงุฑ ุงูุญุงูู:** 2.6.4  
**ุงูุญุงูุฉ:** โ ูุณุชูุฑ ูุฌุงูุฒ ููุฅูุชุงุฌ