# Truth Map - ุฎุฑูุทุฉ ูุตุงุฏุฑ ุงูุญูููุฉ
> ุขุฎุฑ ุชุญุฏูุซ: 2026-01-17

## ๐ ูุตุงุฏุฑ ุงูุจูุงูุงุช ุงูููุญุฏุฉ

ูุฐุง ุงูููู ููุซู ูุตุฏุฑ ูู ุฑูู/ูุคุดุฑ ูู ุงููุธุงู ูุถูุงู ุงูุชูุงุณู ูุชุณููู ุงูุชุชุจุน.

---

## 1. ูุคุดุฑุงุช ุงูุฃุฏุงุก ุงูุฑุฆูุณูุฉ (KPIs)

### 1.1 ุงููุณุชููุฏูู ุงููุดุทูู
| ุงูุนูุตุฑ | ุงููููุฉ |
|--------|--------|
| **ุงูููุญุงุช** | Admin, Nazer, Beneficiaries |
| **ุงูุฌุฏูู** | `beneficiaries` |
| **ุงูููุชุฑ** | `status = 'ูุดุท' OR status = 'active'` |
| **ุงูุฎุฏูุฉ** | `KPIService.getUnifiedKPIs()` |
| **Hook** | `useUnifiedKPIs` |
| **ุงูุซุงุจุช** | `matchesStatus(status, 'active')` |

### 1.2 ุฅุฌูุงูู ุงูุชุญุตูู
| ุงูุนูุตุฑ | ุงููููุฉ |
|--------|--------|
| **ุงูููุญุงุช** | Admin, Nazer, Properties |
| **ุงูุฌุฏูู** | `payment_vouchers` |
| **ุงูููุชุฑ** | `type = 'ูุจุถ' OR type = 'receipt', status = 'paid'` |
| **ุงูุฎุฏูุฉ** | `PropertyStatsService.getCollectionStats()` |
| **Hook** | `useCollectionStats` |
| **ุงูุซุงุจุช** | `COLLECTION_SOURCE` |

### 1.3 ุทูุจุงุช ุงูุตูุงูุฉ ุงูููุชูุญุฉ
| ุงูุนูุตุฑ | ุงููููุฉ |
|--------|--------|
| **ุงูููุญุงุช** | Admin, Properties |
| **ุงูุฌุฏูู** | `maintenance_requests` |
| **ุงูููุชุฑ** | `status IN ('ุฌุฏูุฏ', 'ููุฏ ุงูุชูููุฐ', 'ูู ุงูุงูุชุธุงุฑ', 'ุชุญุช ุงููุฑุงุฌุนุฉ')` |
| **ุงูุฎุฏูุฉ** | `MaintenanceService.getStats()` |
| **Hook** | `useMaintenanceStats` |
| **ุงูุซุงุจุช** | `MAINTENANCE_OPEN_STATUSES` |

### 1.4 ุงูุนููุฏ ุงููุดุทุฉ
| ุงูุนูุตุฑ | ุงููููุฉ |
|--------|--------|
| **ุงูููุญุงุช** | Admin, Nazer, Properties |
| **ุงูุฌุฏูู** | `contracts` |
| **ุงูููุชุฑ** | `status = 'ูุดุท' OR status = 'active'` |
| **ุงูุฎุฏูุฉ** | `KPIService.getUnifiedKPIs()` |
| **Hook** | `useUnifiedKPIs` |
| **ุงูุซุงุจุช** | `matchesStatus(status, 'active')` |

### 1.5 ุงููุณุชุฃุฌุฑูู ุงููุดุทูู
| ุงูุนูุตุฑ | ุงููููุฉ |
|--------|--------|
| **ุงูููุญุงุช** | Admin, Properties, Tenants |
| **ุงูุฌุฏูู** | `tenants` |
| **ุงูููุชุฑ** | `status = 'ูุดุท' OR status = 'active'` |
| **ุงูุฎุฏูุฉ** | `TenantService.getStats()` |
| **Hook** | `useTenants` |
| **ุงูุซุงุจุช** | `matchesStatus(status, 'active')` |

### 1.6 ุงูุนูุงุฑุงุช
| ุงูุนูุตุฑ | ุงููููุฉ |
|--------|--------|
| **ุงูููุญุงุช** | Admin, Properties |
| **ุงูุฌุฏูู** | `properties` |
| **ุงูููุชุฑ** | `status = 'ูุคุฌุฑ' OR status = 'rented'` |
| **ุงูุฎุฏูุฉ** | `PropertyStatsService.getBasicStats()` |
| **Hook** | `usePropertiesStats` |
| **ุงูุซุงุจุช** | `matchesStatus(status, 'rented')` |

---

## 2. ุงูุซูุงุจุช ุงููุณุชุฎุฏูุฉ

### 2.1 ุญุงูุงุช ุงููุณุชููุฏูู (`BENEFICIARY_STATUS`)
```typescript
ACTIVE: 'ูุดุท',
INACTIVE: 'ุบูุฑ ูุดุท',
SUSPENDED: 'ููููู',
PENDING: 'ูุนูู',
DECEASED: 'ูุชููู'
```

### 2.2 ุญุงูุงุช ุงูุนููุฏ (`CONTRACT_STATUS`)
```typescript
ACTIVE: 'ูุดุท',
EXPIRED: 'ููุชูู',
TERMINATED: 'ููุบู',
PENDING: 'ูุนูู',
DRAFT: 'ูุณูุฏุฉ'
```

### 2.3 ุญุงูุงุช ุงููุณุชุฃุฌุฑูู (`TENANT_STATUS`)
```typescript
ACTIVE: 'ูุดุท',
ACTIVE_EN: 'active',
INACTIVE: 'ุบูุฑ ูุดุท',
INACTIVE_EN: 'inactive',
SUSPENDED: 'ููููู',
SUSPENDED_EN: 'suspended'
```

### 2.4 ุญุงูุงุช ุงูุตูุงูุฉ
```typescript
MAINTENANCE_OPEN_STATUSES: ['ุฌุฏูุฏ', 'ููุฏ ุงูุชูููุฐ', 'ูู ุงูุงูุชุธุงุฑ', 'ุชุญุช ุงููุฑุงุฌุนุฉ']
MAINTENANCE_CLOSED_STATUSES: ['ููุชูู', 'ููุบู', 'ูุฑููุถ']
```

---

## 3. ุชุฏูู ุงูุจูุงูุงุช

```
โโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโ
โ   Database  โโโโโถโ   Service   โโโโโถโ    Hook     โโโโโถโ  Component  โ
โ  (Supabase) โ    โ  (*.service)โ    โ  (use*.ts)  โ    โ   (*.tsx)   โ
โโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโ
       โ                  โ                  โ                  โ
       โ                  โ                  โ                  โ
       โผ                  โผ                  โผ                  โผ
  โโโโโโโโโโโ       โโโโโโโโโโโ       โโโโโโโโโโโ       โโโโโโโโโโโ
  โ  Tables โ       โConstantsโ       โ  Cache  โ       โ   UI    โ
  โ   RLS   โ       โ Filters โ       โstaleTimeโ       โ Display โ
  โโโโโโโโโโโ       โโโโโโโโโโโ       โโโโโโโโโโโ       โโโโโโโโโโโ
```

---

## 4. ุงูุฎุฏูุงุช ุงูููุญุฏุฉ

| ุงูุฎุฏูุฉ | ุงููุธููุฉ | withRetry | matchesStatus |
|--------|---------|:---------:|:-------------:|
| `KPIService` | ุงููุคุดุฑุงุช ุงูููุญุฏุฉ | โ | โ |
| `PropertyStatsService` | ุฅุญุตุงุฆูุงุช ุงูุนูุงุฑุงุช | โ | โ |
| `TenantService` | ุฅุญุตุงุฆูุงุช ุงููุณุชุฃุฌุฑูู | โ | โ |
| `MaintenanceService` | ุฅุญุตุงุฆูุงุช ุงูุตูุงูุฉ | โ | โ |
| `BeneficiaryCoreService` | ุฅุญุตุงุฆูุงุช ุงููุณุชููุฏูู | โ | โ |
| `LoansService` | ุฅุญุตุงุฆูุงุช ุงููุฑูุถ | โ | โ |

---

## 5. ุงูููุญุงุช ููุตุงุฏุฑูุง

| ุงูููุญุฉ | Hook ุงูุฑุฆูุณู | ุงูุจูุงูุงุช |
|--------|-------------|----------|
| AdminDashboard | `useUnifiedKPIs` | KPIs + Charts |
| NazerDashboard | `useUnifiedKPIs` | KPIs + Distribution + Activity |
| AccountantDashboard | `useAccountantKPIs` | Journal + Approvals |
| CashierDashboard | `useCashierStats` | POS + Shifts |
| BeneficiaryPortal | `useBeneficiaryData` | Personal Data |
| TenantPortal | `useTenantData` | Contracts + Payments |
| ArchivistDashboard | `useArchiveStats` | Documents + Folders |
| DeveloperDashboard | `useSystemHealth` | Monitoring + Logs |

---

## 6. ููุงุนุฏ ุงูุชุญูู ูู ุงูุญุงูุงุช

### ุงุณุชุฎุฏุงู `matchesStatus()`
```typescript
import { matchesStatus } from '@/lib/constants';

// โ ุตุญูุญ - ูุฏุนู ุงููุบุชูู
const isActive = matchesStatus(tenant.status, 'active');

// โ ุฎุงุทุฆ - ูุง ูุฏุนู ุงููุบุชูู
const isActive = tenant.status === 'ูุดุท';
```

---

## 7. ููุงุญุธุงุช ูููุฉ

1. **ุงูุชูุงุณู**: ุฌููุน ุงูุฃุฑูุงู ูุฌุจ ุฃู ุชุฃุชู ูู ููุณ ุงููุตุฏุฑ
2. **ุงูุซูุงุจุช**: ุงุณุชุฎุฏู `matchesStatus()` ุฏุงุฆูุงู ููููุงุฑูุงุช
3. **ุงููุงุด**: `staleTime` ููุญุฏ ูู `QUERY_CONFIG`
4. **Retry**: ุฌููุน ุงูุฎุฏูุงุช ุงูุญุฑุฌุฉ ุชุณุชุฎุฏู `withRetry`
5. **RLS**: ุชุฃูุฏ ูู ุณูุงุณุงุช ุงููุตูู ูุจู ุงูุงุณุชุนูุงู

---

## 8. ุงูุชุญุฏูุซุงุช

| ุงูุชุงุฑูุฎ | ุงูุชุบููุฑ |
|---------|---------|
| 2026-01-17 | ุฅูุดุงุก ุงูููู ุงูุฃููู |
| 2026-01-17 | ุฅุถุงูุฉ `withRetry` ููุฎุฏูุงุช ุงูุญุฑุฌุฉ |
| 2026-01-17 | ุชูุญูุฏ ุญุงูุงุช ุงููุณุชุฃุฌุฑูู (ุนุฑุจู/ุฅูุฌููุฒู) |
